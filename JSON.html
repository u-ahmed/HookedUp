<html>
<head>
	<script src="http://code.jquery.com/jquery-2.1.4.js"></script>
	<script src="async.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

	<style>
	body {
	background: url(Background2.jpg) repeat ;
	width: 100%;
	height: 100%;

	}

</style>
</head>
<body>
<script>

//var postobjects = ['blog_name','id','post_url','type','timestamp','date','format','reblog_key','tags','bookmarklet','mobile','source_url','source_title','liked','state','total_posts','coordinates','favorited','created_at','id_str','entities','url','hashtags','retweet_count','user','name','profile_image_url','created_time','images','user','videos','comments'];

// alert("Hello!");

async.waterfall([

	function (cb) {
		cb(null, []);
	},

	function (result, cb) {

		$.ajax({
			url: "https://api.instagram.com/v1/users/self/feed?access_token=233291163.8a612cd.c49f77de073746e9a2f53116b720302e",
			method: 'GET',
			dataType: 'jsonp',
			success: function(data, status, ajax) {
				console.log(data);
				result = result.concat(data.data);
				cb(null, result);
			},
			error: function(err) {
				cb(err, result)
			}
		});

	},

	function (result, cb) {

		$.ajax({
			url: "http://socialmediahookedup.tumblr.com/api/read/json",
			method: 'GET',
			dataType: 'jsonp',
			success: function(data, status, ajax) {
				console.log(data);
				result = result.concat(data.posts);
				cb(null, result);
			},
			error: function(err) {
				cb(err, result)
			}
		});

	},
/*
	function (result, cb) {

		$.ajax({
			headers: {
				'Authorization' : 'OAuth oauth_consumer_key="4BxNrNc2312oakaBHCusk3ryo", oauth_nonce="8ab038d4b34843a4c1dd5600d87e08b4", oauth_signature="B9hQcY7fYwtbgLNi0qOKdhiTVt0%3D", oauth_signature_method="HMAC-SHA1", oauth_timestamp="1438359129", oauth_token="3297223770-jC5411hhsODUXU6qbqTCbwFujaGliqVTtX9iwFK", oauth_version="1.0"'
			},
			url: "https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=FightMe123456",
			method: 'GET',
			dataType: 'json',
			success: function(data, status, ajax) {
				for(i=0; i<result.length; i++){
					item = result[i]
				}
				console.log(data);
				result = result.concat(data.posts);
				cb(null, result);
			},
			error: function(err) {
				cb(err, result)
			}
		});

	},
*/
	function (result, cb) {

		result.sort(function(a, b) {

			/*if(a.created_time) {
				timestampA = parseInt(a.created_time);
			} else if(a['unix-timestamp']) {
				timestampA = a['unix-timestamp'];
			}

			if(b.created_time) {
				timestampB = parseInt(a.created_time);
			} else if(b['unix-timestamp']) {
				timestampB = b['unix-timestamp'];
			}*/

			a.timestamp = a['unix-timestamp'] || parseInt(a.created_time);
			b.timestamp = b['unix-timestamp'] || parseInt(b.created_time);

			if(a['photo-url-1280']) {
				a.phimages = a['photo-url-1280']
			} else if (a.images) {
				a.phimages = a.images['standard_resolution'].url;
			}

			if(a.user) {
			  a.postername = a.user.username;
			}

			if(a.caption) {
				a.captionbody = a.caption.text
			} else if (a.slug) {
				a.captionbody = a.slug;
			}

			if(a['video-player']){
				a.playervideos = a['video-player']
			}
		  else if (a.videos) {
		  	a.playervideos = a.videos
		  }

			if(a['link-url']){
				a.link = a['link-url']
			}

			if(a['link-text']){
				a.linkt= a['link-text']
			}

			if (a.timestamp == b.timestamp) { return 0; }
    	if (a.timestamp > b.timestamp) {
        return -1;
    	} else {
        return 1;
    	}

		});

		cb(null, result);

	}

], function (err, result) {
	console.log(err);
	console.log('Hello World!');
  console.log(result);

	for(i=0; i<result.length; i++) {
		item = result[i]

		 if(item.postername){
			$( "#feed" ).append( '<p><tr><td><div id="username" align="left">'+ item.postername + '</div></td><td></td>/<tr></p>' );
}
		if(item.phimages){
			$( "#feed" ).append( '<p><tr><td></td><td><div id="content" align="middle"><img src="'+ item.phimages +'"></div></td></tr></p>' );
		}
		if(item.captionbody){
			$( "#feed" ).append( '<p><tr><td></td><td><div id="content" align="middle">'+ item.captionbody + '</div></td></tr></p>' );
		}
		if(item.playervideos){
			$( "#feed" ).append( '<p><tr><td></td><td><div id="content" align="middle">'+ item.playervideos + '</div></td></tr></p>' );
		}
		if(item['quote-text']){
			$( "#feed" ).append( '<p><tr><td></td><td><div id="content" align="middle">'+ item['quote-text'] + item['quote-source'] +'</div></td></tr></p>');
		}
		if(item['url']){
			$( "#feed" ).append( '<p><tr><td></td><td><div id="content" align="middle">'+ item['url'] + item['excerpt'] +'</div></td></tr></p>' );
		}
		if(item['question']){
			$( "#feed" ).append( '<p><tr><td></td><td><div id="content" align="middle">'+ item['question']+ item['answer']+'</div></td></tr></p>' );
		}
		if(item.link){
			$( "#feed" ).append( '<p><tr><td></td><td><div id="content" align="middle"><a href="'+ item.link +'">'+item.linkt+'</a></div></td></tr></p>' );
		}
	}
});
</script>

<div id="thecontainer">
	<div id="feed" align="middle">
		<a href="http://www.socialmediahookedup.co.uk"><img src="Logo.png" class="logo" align="left"></a>
	</div>
</div>

</body>
</html>
