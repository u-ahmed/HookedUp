<html>
<head>
	<script src="http://code.jquery.com/jquery-2.1.4.js"></script>
	<script src="async.js"></script>
</head>
<body>
<script>

var postobjects = ['blog_name','id','post_url','type','timestamp','date','format','reblog_key','tags','bookmarklet','mobile','source_url','source_title','liked','state','total_posts','coordinates','favorited','created_at','id_str','entities','url','hashtags','retweet_count','user','name','profile_image_url','created_time','images','user','videos','comments'];

// alert("Hello!");

async.waterfall([

	function (cb) {
		cb(null, []);
	},

	function (result, cb) {

		$.ajax({
			url: "https://api.instagram.com/v1/users/self/feed?access_token=233291163.8a612cd.c49f77de073746e9a2f53116b720302e",
			method: 'GET',
			dataType: 'jsonp',
			success: function(data, status, ajax) {
				console.log(data);
				result = result.concat(data.data);
				cb(null, result);
			},
			error: function(err) {
				cb(err, result)
			}
		});

	},

	function (result, cb) {

		$.ajax({
			url: "http://justalexthings.tumblr.com/api/read/json",
			method: 'GET',
			dataType: 'jsonp',
			success: function(data, status, ajax) {
				console.log(data);
				result = result.concat(data.posts);
				cb(null, result);
			},
			error: function(err) {
				cb(err, result)
			}
		});

	},

	function (result, cb) {

		$.ajax({
			headers: {
				'Authorization' : 'OAuth oauth_consumer_key="4BxNrNc2312oakaBHCusk3ryo", oauth_nonce="8ab038d4b34843a4c1dd5600d87e08b4", oauth_signature="B9hQcY7fYwtbgLNi0qOKdhiTVt0%3D", oauth_signature_method="HMAC-SHA1", oauth_timestamp="1438359129", oauth_token="3297223770-jC5411hhsODUXU6qbqTCbwFujaGliqVTtX9iwFK", oauth_version="1.0"'
			},
			url: "https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=FightMe123456",
			method: 'GET',
			dataType: 'jsonp',
			success: function(data, status, ajax) {
				for(i=0; i<result.length; i++){
					item = result[i]
				}
				console.log(data);
				result = result.concat(data.posts);
				cb(null, result);
			},
			error: function(err) {
				cb(err, result)
			}
		});

	},

	function (result, cb) {

		result.sort(function(a, b) {

			/*if(a.created_time) {
				timestampA = parseInt(a.created_time);
			} else if(a['unix-timestamp']) {
				timestampA = a['unix-timestamp'];
			}

			if(b.created_time) {
				timestampB = parseInt(a.created_time);
			} else if(b['unix-timestamp']) {
				timestampB = b['unix-timestamp'];
			}*/

			a.timestamp = a['unix-timestamp'] || parseInt(a.created_time);
			b.timestamp = b['unix-timestamp'] || parseInt(b.created_time);

			if (a.timestamp == b.timestamp) { return 0; }
    	if (a.timestamp > b.timestamp) {
        return -1;
    	} else {
        return 1;
    	}

		});

		cb(null, result);

	}

], function (err, result) {
	console.log(err);
	console.log('Hello World!');
  console.log(result);

	for(i=0; i<result.length; i++){
		item = result[i]

		for(key in item) {
			$( "#feed" ).append( "<p>"+ item[key] +"</p>" );
		}
	}
});

/*
$.ajax({
	url: localStorage.getItem("tumblr link"),
	method: 'GET',
	dataType: 'jsonp',
	success: function(data, status, ajax) {
		console.log(data.data);
		console.log(status);
	},
	error: function() {
		console.log('There was an error!');
	}
});

$.ajax({
	url: localStorage.getItem("instagram link"),
	method: 'GET',
	dataType: 'jsonp',
	success: function(data, status, ajax) {
		console.log(data.data);
		console.log(status);
	},
	error: function() {
		console.log('There was an error!');
	}
});


$.ajax({
	url: "https://api.instagram.com/v1/users/self/feed?access_token=233291163.8a612cd.c49f77de073746e9a2f53116b720302e",
	method: 'GET',
	dataType: 'jsonp',
	success: function(data, status, ajax) {
		console.log(data.data);
		console.log(status);
	},
	error: function() {
		console.log('There was an error!');
	}
});
*/

//var instagramJSON = $.get("https://api.instagram.com/v1/users/self/feed?access_token=233291163.8a612cd.c49f77de073746e9a2f53116b720302e",
 //function(data) {	alert(data);};

/*
		function(feed) {
			// Create an empty array to store images
			var thumbs = [];

			// Loop through the items
			for(var i=0, l= postobjects.length; i < l; ++i)
			{
				// Manipulate the image to get thumb and medium sizes
				var img = feed.items[i].media.m.replace(
					/^(.*?)_m\.jpg$/,
					'<a href="$1.jpg"><img src="$1_s.jpg" alt="" /></a>'
				);

				// Add the new element to the array
				thumbs.push(img);
			}

			// Display the thumbnails on the page
			$('#feed').html(thumbs.join(''));

			// A function to add a lightbox effect
			addLB();
		},
		dataType:'jsonp'
	});
*/
</script>
<div id="feed"></div>
</body>
</html>
